_gaussian_quadrature_coeffs_string = """
0.000000000000000 2.000000000000000 
1.000000000000000 -0.577350269189626 
1.000000000000000 0.577350269189626 
0.888888888888889 0.000000000000000 
0.555555555555556 -0.774596669241483 
0.555555555555556 0.774596669241483 
0.652145154862546 -0.339981043584856 
0.652145154862546 0.339981043584856 
0.347854845137454 -0.861136311594053 
0.347854845137454 0.861136311594053 
0.568888888888889 0.000000000000000 
0.478628670499367 -0.538469310105683 
0.478628670499367 0.538469310105683 
0.236926885056189 -0.906179845938664 
0.236926885056189 0.906179845938664 
0.360761573048139 0.661209386466264 
0.360761573048139 -0.661209386466264 
0.467913934572691 -0.238619186083197 
0.467913934572691 0.238619186083197 
0.171324492379170 -0.932469514203152 
0.171324492379170 0.932469514203152 
0.417959183673469 0.000000000000000 
0.381830050505119 0.405845151377397 
0.381830050505119 -0.405845151377397 
0.279705391489277 -0.741531185599394 
0.279705391489277 0.741531185599394 
0.129484966168870 -0.949107912342758 
0.129484966168870 0.949107912342758"""

_gaussian_quadrature_coeffs = [
2.000000000000000 0.000000000000000
-0.577350269189626 1.000000000000000
0.577350269189626 1.000000000000000
0.000000000000000 0.888888888888889
-0.774596669241483 0.555555555555556
0.774596669241483 0.555555555555556
-0.339981043584856 0.652145154862546
0.339981043584856 0.652145154862546
-0.861136311594053 0.347854845137454
0.861136311594053 0.347854845137454
0.000000000000000 0.568888888888889
-0.538469310105683 0.478628670499367
0.538469310105683 0.478628670499367
-0.906179845938664 0.236926885056189
0.906179845938664 0.236926885056189
0.661209386466264 0.360761573048139
-0.661209386466264 0.360761573048139
-0.238619186083197 0.467913934572691
0.238619186083197 0.467913934572691
-0.932469514203152 0.171324492379170
0.932469514203152 0.171324492379170
0.000000000000000 0.417959183673469
0.405845151377397 0.381830050505119
-0.405845151377397 0.381830050505119
-0.741531185599394 0.279705391489277
0.741531185599394 0.279705391489277
-0.949107912342758 0.129484966168870
0.949107912342758 0.129484966168870]


function gaussian_quadrature_coeffs(n::Integer)
    if n < 0 || n > 8
        @error("order should be 1 ≤ n ≤ 7")
    end
    x = _gaussian_quadrature_coeffs[(((n-1)*n ÷ 2) +1) : (((n+1)*n ÷ 2)), 1:2]
    return x[:,1], x[:,2]
end

function integrate_gauss_quadrature(fct::Function, order::Integer, a::Real, b::Real)
    @assert 1 ≤ order ≤ 7
    @assert b>a
    xs, cs = gaussian_quadrature_coeffs(order)
    ss(t) = ((b-a)*t+(b+a)) * 0.5
    return ([fct(ss(xs[i])) * cs[i] for i in 1:order] |>sum)*(b-a)/2
end
